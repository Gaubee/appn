Promise.withResolvers===void 0&&(Promise.withResolvers=()=>{const e={};return e.promise=new Promise((t,n)=>{e.resolve=t,e.reject=n}),e});const G=e=>e.call.bind(e),H=e=>function(...t){return e(this,...t)},Q=(e,t)=>{let n;const i=Object.assign(function(...s){const c=t?.apply(this,s);return(n===void 0||c!==n.key)&&(n={key:c,res:e.apply(this,s)}),n.res},{get source(){return e},get key(){return n?.key},get runned(){return n!=null},get returnValue(){return n?.res},reset(){n=void 0},rerun(...s){return i.reset(),i(...s)}});return Object.defineProperties(i,{source:{value:e,writable:!1,configurable:!0,enumerable:!0},key:{get:()=>n?.key,configurable:!0,enumerable:!0},runned:{get:()=>n!=null,configurable:!0,enumerable:!0},returnValue:{get:()=>n?.res,configurable:!0,enumerable:!0}}),i},X=e=>{let t;return new Proxy(e,{apply(n,r,i){return t==null&&(t=Reflect.apply(e,r,i)),Reflect.apply(t,r,i)}})},f=Symbol.for("@ts-pattern/matcher"),R=Symbol.for("@ts-pattern/isVariadic"),K="@ts-pattern/anonymous-select-key",_=e=>!!(e&&typeof e=="object"),x=e=>e&&!!e[f],a=(e,t,n)=>{if(x(e)){const r=e[f](),{matched:i,selections:s}=r.match(t);return i&&s&&Object.keys(s).forEach(c=>n(c,s[c])),i}if(_(e)){if(!_(t))return!1;if(Array.isArray(e)){if(!Array.isArray(t))return!1;let r=[],i=[],s=[];for(const c of e.keys()){const h=e[c];x(h)&&h[R]?s.push(h):s.length?i.push(h):r.push(h)}if(s.length){if(s.length>1)throw new Error("Pattern error: Using `...P.array(...)` several times in a single pattern is not allowed.");if(t.length<r.length+i.length)return!1;const c=t.slice(0,r.length),h=i.length===0?[]:t.slice(-i.length),j=t.slice(r.length,i.length===0?1/0:-i.length);return r.every((y,S)=>a(y,c[S],n))&&i.every((y,S)=>a(y,h[S],n))&&(s.length===0||a(s[0],j,n))}return e.length===t.length&&e.every((c,h)=>a(c,t[h],n))}return Reflect.ownKeys(e).every(r=>{const i=e[r];return(r in t||x(s=i)&&s[f]().matcherType==="optional")&&a(i,t[r],n);var s})}return Object.is(t,e)},g=e=>{var t,n,r;return _(e)?x(e)?(t=(n=(r=e[f]()).getSelectionKeys)==null?void 0:n.call(r))!=null?t:[]:Array.isArray(e)?O(e,g):O(Object.values(e),g):[]},O=(e,t)=>e.reduce((n,r)=>n.concat(t(r)),[]);function W(...e){if(e.length===1){const[t]=e;return n=>a(t,n,()=>{})}if(e.length===2){const[t,n]=e;return a(t,n,()=>{})}throw new Error(`isMatching wasn't given the right number of arguments: expected 1 or 2, received ${e.length}.`)}function l(e){return Object.assign(e,{optional:()=>A(e),and:t=>u(e,t),or:t=>B(e,t),select:t=>t===void 0?P(e):P(t,e)})}function E(e){return Object.assign((t=>Object.assign(t,{[Symbol.iterator](){let n=0;const r=[{value:Object.assign(t,{[R]:!0}),done:!1},{done:!0,value:void 0}];return{next:()=>{var i;return(i=r[n++])!=null?i:r.at(-1)}}}}))(e),{optional:()=>E(A(e)),select:t=>E(t===void 0?P(e):P(t,e))})}function A(e){return l({[f]:()=>({match:t=>{let n={};const r=(i,s)=>{n[i]=s};return t===void 0?(g(e).forEach(i=>r(i,void 0)),{matched:!0,selections:n}):{matched:a(e,t,r),selections:n}},getSelectionKeys:()=>g(e),matcherType:"optional"})})}const z=(e,t)=>{for(const n of e)if(!t(n))return!1;return!0},$=(e,t)=>{for(const[n,r]of e.entries())if(!t(r,n))return!1;return!0};function u(...e){return l({[f]:()=>({match:t=>{let n={};const r=(i,s)=>{n[i]=s};return{matched:e.every(i=>a(i,t,r)),selections:n}},getSelectionKeys:()=>O(e,g),matcherType:"and"})})}function B(...e){return l({[f]:()=>({match:t=>{let n={};const r=(i,s)=>{n[i]=s};return O(e,g).forEach(i=>r(i,void 0)),{matched:e.some(i=>a(i,t,r)),selections:n}},getSelectionKeys:()=>O(e,g),matcherType:"or"})})}function o(e){return{[f]:()=>({match:t=>({matched:!!e(t)})})}}function P(...e){const t=typeof e[0]=="string"?e[0]:void 0,n=e.length===2?e[1]:typeof e[0]=="string"?void 0:e[0];return l({[f]:()=>({match:r=>{let i={[t??K]:r};return{matched:n===void 0||a(n,r,(s,c)=>{i[s]=c}),selections:i}},getSelectionKeys:()=>[t??K].concat(n===void 0?[]:g(n))})})}function m(e){return typeof e=="number"}function p(e){return typeof e=="string"}function v(e){return typeof e=="bigint"}const N=l(o(function(e){return!0})),F=N,b=e=>Object.assign(l(e),{startsWith:t=>{return b(u(e,(n=t,o(r=>p(r)&&r.startsWith(n)))));var n},endsWith:t=>{return b(u(e,(n=t,o(r=>p(r)&&r.endsWith(n)))));var n},minLength:t=>b(u(e,(n=>o(r=>p(r)&&r.length>=n))(t))),length:t=>b(u(e,(n=>o(r=>p(r)&&r.length===n))(t))),maxLength:t=>b(u(e,(n=>o(r=>p(r)&&r.length<=n))(t))),includes:t=>{return b(u(e,(n=t,o(r=>p(r)&&r.includes(n)))));var n},regex:t=>{return b(u(e,(n=t,o(r=>p(r)&&!!r.match(n)))));var n}}),L=b(o(p)),d=e=>Object.assign(l(e),{between:(t,n)=>d(u(e,((r,i)=>o(s=>m(s)&&r<=s&&i>=s))(t,n))),lt:t=>d(u(e,(n=>o(r=>m(r)&&r<n))(t))),gt:t=>d(u(e,(n=>o(r=>m(r)&&r>n))(t))),lte:t=>d(u(e,(n=>o(r=>m(r)&&r<=n))(t))),gte:t=>d(u(e,(n=>o(r=>m(r)&&r>=n))(t))),int:()=>d(u(e,o(t=>m(t)&&Number.isInteger(t)))),finite:()=>d(u(e,o(t=>m(t)&&Number.isFinite(t)))),positive:()=>d(u(e,o(t=>m(t)&&t>0))),negative:()=>d(u(e,o(t=>m(t)&&t<0)))}),V=d(o(m)),w=e=>Object.assign(l(e),{between:(t,n)=>w(u(e,((r,i)=>o(s=>v(s)&&r<=s&&i>=s))(t,n))),lt:t=>w(u(e,(n=>o(r=>v(r)&&r<n))(t))),gt:t=>w(u(e,(n=>o(r=>v(r)&&r>n))(t))),lte:t=>w(u(e,(n=>o(r=>v(r)&&r<=n))(t))),gte:t=>w(u(e,(n=>o(r=>v(r)&&r>=n))(t))),positive:()=>w(u(e,o(t=>v(t)&&t>0))),negative:()=>w(u(e,o(t=>v(t)&&t<0)))}),M=w(o(v)),I=l(o(function(e){return typeof e=="boolean"})),J=l(o(function(e){return typeof e=="symbol"})),U=l(o(function(e){return e==null})),q=l(o(function(e){return e!=null}));var Y={__proto__:null,matcher:f,optional:A,array:function(...e){return E({[f]:()=>({match:t=>{if(!Array.isArray(t))return{matched:!1};if(e.length===0)return{matched:!0};const n=e[0];let r={};if(t.length===0)return g(n).forEach(s=>{r[s]=[]}),{matched:!0,selections:r};const i=(s,c)=>{r[s]=(r[s]||[]).concat([c])};return{matched:t.every(s=>a(n,s,i)),selections:r}},getSelectionKeys:()=>e.length===0?[]:g(e[0])})})},set:function(...e){return l({[f]:()=>({match:t=>{if(!(t instanceof Set))return{matched:!1};let n={};if(t.size===0)return{matched:!0,selections:n};if(e.length===0)return{matched:!0};const r=(s,c)=>{n[s]=(n[s]||[]).concat([c])},i=e[0];return{matched:z(t,s=>a(i,s,r)),selections:n}},getSelectionKeys:()=>e.length===0?[]:g(e[0])})})},map:function(...e){return l({[f]:()=>({match:t=>{if(!(t instanceof Map))return{matched:!1};let n={};if(t.size===0)return{matched:!0,selections:n};const r=(h,j)=>{n[h]=(n[h]||[]).concat([j])};if(e.length===0)return{matched:!0};var i;if(e.length===1)throw new Error(`\`P.map\` wasn't given enough arguments. Expected (key, value), received ${(i=e[0])==null?void 0:i.toString()}`);const[s,c]=e;return{matched:$(t,(h,j)=>{const y=a(s,j,r),S=a(c,h,r);return y&&S}),selections:n}},getSelectionKeys:()=>e.length===0?[]:[...g(e[0]),...g(e[1])]})})},intersection:u,union:B,not:function(e){return l({[f]:()=>({match:t=>({matched:!a(e,t,()=>{})}),getSelectionKeys:()=>[],matcherType:"not"})})},when:o,select:P,any:N,_:F,string:L,number:V,bigint:M,boolean:I,symbol:J,nullish:U,nonNullable:q,instanceOf:function(e){return l(o(function(t){return n=>n instanceof t}(e)))},shape:function(e){return l(o(W(e)))}};class C extends Error{constructor(t){let n;try{n=JSON.stringify(t)}catch{n=t}super(`Pattern matching error: no pattern matches value ${n}`),this.input=void 0,this.input=t}}const T={matched:!1,value:void 0};function Z(e){return new k(e,T)}class k{constructor(t,n){this.input=void 0,this.state=void 0,this.input=t,this.state=n}with(...t){if(this.state.matched)return this;const n=t[t.length-1],r=[t[0]];let i;t.length===3&&typeof t[1]=="function"?i=t[1]:t.length>2&&r.push(...t.slice(1,t.length-1));let s=!1,c={};const h=(y,S)=>{s=!0,c[y]=S},j=!r.some(y=>a(y,this.input,h))||i&&!i(this.input)?T:{matched:!0,value:n(s?K in c?c[K]:c:this.input,this.input)};return new k(this.input,j)}when(t,n){if(this.state.matched)return this;const r=!!t(this.input);return new k(this.input,r?{matched:!0,value:n(this.input,this.input)}:T)}otherwise(t){return this.state.matched?this.state.value:t(this.input)}exhaustive(t=D){return this.state.matched?this.state.value:t(this.input)}run(){return this.exhaustive()}returnType(){return this}}function D(e){throw new C(e)}Promise.withResolvers===void 0&&(Promise.withResolvers=()=>{const e={};return e.promise=new Promise((t,n)=>{e.resolve=t,e.reject=n}),e});export{Y as N,X as a,H as c,Q as f,G as u,Z as z};

Promise.withResolvers===void 0&&(Promise.withResolvers=()=>{const e={};return e.promise=new Promise((t,n)=>{e.resolve=t,e.reject=n}),e});const G=e=>e.call.bind(e),H=e=>function(...t){return e(this,...t)},Q=(e,t)=>{let n;const i=Object.assign(function(...s){const c=t?.apply(this,s);return(n===void 0||c!==n.key)&&(n={key:c,res:e.apply(this,s)}),n.res},{get source(){return e},get key(){return n?.key},get runned(){return n!=null},get returnValue(){return n?.res},reset(){n=void 0},rerun(...s){return i.reset(),i(...s)}});return Object.defineProperties(i,{source:{value:e,writable:!1,configurable:!0,enumerable:!0},key:{get:()=>n?.key,configurable:!0,enumerable:!0},runned:{get:()=>n!=null,configurable:!0,enumerable:!0},returnValue:{get:()=>n?.res,configurable:!0,enumerable:!0}}),i},X=e=>{let t;return new Proxy(e,{apply(n,r,i){return t==null&&(t=Reflect.apply(e,r,i)),Reflect.apply(t,r,i)}})},f=Symbol.for("@ts-pattern/matcher"),B=Symbol.for("@ts-pattern/isVariadic"),k="@ts-pattern/anonymous-select-key",E=e=>!!(e&&typeof e=="object"),K=e=>e&&!!e[f],a=(e,t,n)=>{if(K(e)){const r=e[f](),{matched:i,selections:s}=r.match(t);return i&&s&&Object.keys(s).forEach(c=>n(c,s[c])),i}if(E(e)){if(!E(t))return!1;if(Array.isArray(e)){if(!Array.isArray(t))return!1;let r=[],i=[],s=[];for(const c of e.keys()){const h=e[c];K(h)&&h[B]?s.push(h):s.length?i.push(h):r.push(h)}if(s.length){if(s.length>1)throw new Error("Pattern error: Using `...P.array(...)` several times in a single pattern is not allowed.");if(t.length<r.length+i.length)return!1;const c=t.slice(0,r.length),h=i.length===0?[]:t.slice(-i.length),S=t.slice(r.length,i.length===0?1/0:-i.length);return r.every((y,j)=>a(y,c[j],n))&&i.every((y,j)=>a(y,h[j],n))&&(s.length===0||a(s[0],S,n))}return e.length===t.length&&e.every((c,h)=>a(c,t[h],n))}return Reflect.ownKeys(e).every(r=>{const i=e[r];return(r in t||K(s=i)&&s[f]().matcherType==="optional")&&a(i,t[r],n);var s})}return Object.is(t,e)},g=e=>{var t,n,r;return E(e)?K(e)?(t=(n=(r=e[f]()).getSelectionKeys)==null?void 0:n.call(r))!=null?t:[]:Array.isArray(e)?O(e,g):O(Object.values(e),g):[]},O=(e,t)=>e.reduce((n,r)=>n.concat(t(r)),[]);function W(...e){if(e.length===1){const[t]=e;return n=>a(t,n,()=>{})}if(e.length===2){const[t,n]=e;return a(t,n,()=>{})}throw new Error(`isMatching wasn't given the right number of arguments: expected 1 or 2, received ${e.length}.`)}function l(e){return Object.assign(e,{optional:()=>A(e),and:t=>o(e,t),or:t=>N(e,t),select:t=>t===void 0?x(e):x(t,e)})}function P(e){return Object.assign((t=>Object.assign(t,{[Symbol.iterator](){let n=0;const r=[{value:Object.assign(t,{[B]:!0}),done:!1},{done:!0,value:void 0}];return{next:()=>{var i;return(i=r[n++])!=null?i:r.at(-1)}}}}))(e),{optional:()=>P(A(e)),select:t=>P(t===void 0?x(e):x(t,e))})}function A(e){return l({[f]:()=>({match:t=>{let n={};const r=(i,s)=>{n[i]=s};return t===void 0?(g(e).forEach(i=>r(i,void 0)),{matched:!0,selections:n}):{matched:a(e,t,r),selections:n}},getSelectionKeys:()=>g(e),matcherType:"optional"})})}const z=(e,t)=>{for(const n of e)if(!t(n))return!1;return!0},$=(e,t)=>{for(const[n,r]of e.entries())if(!t(r,n))return!1;return!0};function o(...e){return l({[f]:()=>({match:t=>{let n={};const r=(i,s)=>{n[i]=s};return{matched:e.every(i=>a(i,t,r)),selections:n}},getSelectionKeys:()=>O(e,g),matcherType:"and"})})}function N(...e){return l({[f]:()=>({match:t=>{let n={};const r=(i,s)=>{n[i]=s};return O(e,g).forEach(i=>r(i,void 0)),{matched:e.some(i=>a(i,t,r)),selections:n}},getSelectionKeys:()=>O(e,g),matcherType:"or"})})}function u(e){return{[f]:()=>({match:t=>({matched:!!e(t)})})}}function x(...e){const t=typeof e[0]=="string"?e[0]:void 0,n=e.length===2?e[1]:typeof e[0]=="string"?void 0:e[0];return l({[f]:()=>({match:r=>{let i={[t??k]:r};return{matched:n===void 0||a(n,r,(s,c)=>{i[s]=c}),selections:i}},getSelectionKeys:()=>[t??k].concat(n===void 0?[]:g(n))})})}function m(e){return typeof e=="number"}function p(e){return typeof e=="string"}function v(e){return typeof e=="bigint"}const R=l(u(function(e){return!0})),F=R,b=e=>Object.assign(l(e),{startsWith:t=>{return b(o(e,(n=t,u(r=>p(r)&&r.startsWith(n)))));var n},endsWith:t=>{return b(o(e,(n=t,u(r=>p(r)&&r.endsWith(n)))));var n},minLength:t=>b(o(e,(n=>u(r=>p(r)&&r.length>=n))(t))),length:t=>b(o(e,(n=>u(r=>p(r)&&r.length===n))(t))),maxLength:t=>b(o(e,(n=>u(r=>p(r)&&r.length<=n))(t))),includes:t=>{return b(o(e,(n=t,u(r=>p(r)&&r.includes(n)))));var n},regex:t=>{return b(o(e,(n=t,u(r=>p(r)&&!!r.match(n)))));var n}}),L=b(u(p)),d=e=>Object.assign(l(e),{between:(t,n)=>d(o(e,((r,i)=>u(s=>m(s)&&r<=s&&i>=s))(t,n))),lt:t=>d(o(e,(n=>u(r=>m(r)&&r<n))(t))),gt:t=>d(o(e,(n=>u(r=>m(r)&&r>n))(t))),lte:t=>d(o(e,(n=>u(r=>m(r)&&r<=n))(t))),gte:t=>d(o(e,(n=>u(r=>m(r)&&r>=n))(t))),int:()=>d(o(e,u(t=>m(t)&&Number.isInteger(t)))),finite:()=>d(o(e,u(t=>m(t)&&Number.isFinite(t)))),positive:()=>d(o(e,u(t=>m(t)&&t>0))),negative:()=>d(o(e,u(t=>m(t)&&t<0)))}),V=d(u(m)),w=e=>Object.assign(l(e),{between:(t,n)=>w(o(e,((r,i)=>u(s=>v(s)&&r<=s&&i>=s))(t,n))),lt:t=>w(o(e,(n=>u(r=>v(r)&&r<n))(t))),gt:t=>w(o(e,(n=>u(r=>v(r)&&r>n))(t))),lte:t=>w(o(e,(n=>u(r=>v(r)&&r<=n))(t))),gte:t=>w(o(e,(n=>u(r=>v(r)&&r>=n))(t))),positive:()=>w(o(e,u(t=>v(t)&&t>0))),negative:()=>w(o(e,u(t=>v(t)&&t<0)))}),M=w(u(v)),I=l(u(function(e){return typeof e=="boolean"})),J=l(u(function(e){return typeof e=="symbol"})),U=l(u(function(e){return e==null})),q=l(u(function(e){return e!=null}));var Y={__proto__:null,matcher:f,optional:A,array:function(...e){return P({[f]:()=>({match:t=>{if(!Array.isArray(t))return{matched:!1};if(e.length===0)return{matched:!0};const n=e[0];let r={};if(t.length===0)return g(n).forEach(s=>{r[s]=[]}),{matched:!0,selections:r};const i=(s,c)=>{r[s]=(r[s]||[]).concat([c])};return{matched:t.every(s=>a(n,s,i)),selections:r}},getSelectionKeys:()=>e.length===0?[]:g(e[0])})})},set:function(...e){return l({[f]:()=>({match:t=>{if(!(t instanceof Set))return{matched:!1};let n={};if(t.size===0)return{matched:!0,selections:n};if(e.length===0)return{matched:!0};const r=(s,c)=>{n[s]=(n[s]||[]).concat([c])},i=e[0];return{matched:z(t,s=>a(i,s,r)),selections:n}},getSelectionKeys:()=>e.length===0?[]:g(e[0])})})},map:function(...e){return l({[f]:()=>({match:t=>{if(!(t instanceof Map))return{matched:!1};let n={};if(t.size===0)return{matched:!0,selections:n};const r=(h,S)=>{n[h]=(n[h]||[]).concat([S])};if(e.length===0)return{matched:!0};var i;if(e.length===1)throw new Error(`\`P.map\` wasn't given enough arguments. Expected (key, value), received ${(i=e[0])==null?void 0:i.toString()}`);const[s,c]=e;return{matched:$(t,(h,S)=>{const y=a(s,S,r),j=a(c,h,r);return y&&j}),selections:n}},getSelectionKeys:()=>e.length===0?[]:[...g(e[0]),...g(e[1])]})})},intersection:o,union:N,not:function(e){return l({[f]:()=>({match:t=>({matched:!a(e,t,()=>{})}),getSelectionKeys:()=>[],matcherType:"not"})})},when:u,select:x,any:R,_:F,string:L,number:V,bigint:M,boolean:I,symbol:J,nullish:U,nonNullable:q,instanceOf:function(e){return l(u(function(t){return n=>n instanceof t}(e)))},shape:function(e){return l(u(W(e)))}};class C extends Error{constructor(t){let n;try{n=JSON.stringify(t)}catch{n=t}super(`Pattern matching error: no pattern matches value ${n}`),this.input=void 0,this.input=t}}const T={matched:!1,value:void 0};function Z(e){return new _(e,T)}class _{constructor(t,n){this.input=void 0,this.state=void 0,this.input=t,this.state=n}with(...t){if(this.state.matched)return this;const n=t[t.length-1],r=[t[0]];let i;t.length===3&&typeof t[1]=="function"?i=t[1]:t.length>2&&r.push(...t.slice(1,t.length-1));let s=!1,c={};const h=(y,j)=>{s=!0,c[y]=j},S=!r.some(y=>a(y,this.input,h))||i&&!i(this.input)?T:{matched:!0,value:n(s?k in c?c[k]:c:this.input,this.input)};return new _(this.input,S)}when(t,n){if(this.state.matched)return this;const r=!!t(this.input);return new _(this.input,r?{matched:!0,value:n(this.input,this.input)}:T)}otherwise(t){return this.state.matched?this.state.value:t(this.input)}exhaustive(t=D){return this.state.matched?this.state.value:t(this.input)}run(){return this.exhaustive()}returnType(){return this}}function D(e){throw new C(e)}export{Y as N,Q as a,H as c,X as f,G as u,Z as z};
